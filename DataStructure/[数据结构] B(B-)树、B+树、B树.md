#1.　B树

　　Ｂ树及Ｂ－树，是一种自平衡的树，能够**保持数据有序**。这种数据结构能够让查找数据、顺序访问、插入数据及删除的动作，都在对数时间内完成。

　　B树，概括来说是一个一般化的**二叉查找树**（binary search tree），可以拥有**多于2个子节点**。与自平衡二叉查找树不同，B树为系统大块数据的读写操作做了优化。B树减少定位记录时所经历的中间过程，从而加快存取速度。B树这种数据结构可以用来描述外部存储。这种数据结构常被应用在数据库和文件系统的实作上。

##1.1　B树的性质

M为树的阶数，B-树或为空树，否则满足下列条件：

1.　定义任意非叶子结点最多只有M个儿子；且M>2；

2.　根结点的儿子数为[2, M]；

3.　除根结点以外的非叶子结点的儿子数为[M/2, M]；

4.　每个结点存放至少M/2-1（取上整）和至多M-1个关键字；（至少2个关键字）

5.　非叶子结点的关键字个数=指向儿子的指针个数-1；

6.　非叶子结点的关键字：K[1], K[2], …, K[M-1]；且K[i] < K[i+1]；

7.　非叶子结点的指针：P[1], P[2], …, P[M]；其中P[1]指向关键字小于K[1]的子树，P[M]指向关键字大于K[M-1]的子树，其它P[i]指向关键字属于(K[i-1], K[i])的子树；

8.　所有叶子结点位于同一层；


如：（M=3）
![这里写图片描述](http://img.blog.csdn.net/20160612115550177)

　　B-树的搜索，从根结点开始，对结点内的关键字（有序）序列进行二分查找，如果命中则结束，否则进入查询关键字所属范围的儿子结点；重复，直到所对应的儿子指针为空，或已经是叶子结点。


##1.２　B树的运用场景

 - 保持**键值有序**，以顺序遍历

 - 使用**层次化的索引来最小化磁盘读取**

 - 使用**不完全填充**的块来加速插入和删除

 - 通过优雅的遍历算法来保持**索引平衡**
 
 另外，B树通过保证内部节点至少半满来**最小化空间浪费**。一棵B树可以处理任意数目的插入和删除。


#２.　B＋树

　　B+ 树是一种树数据结构，是一个**n叉树**，每个节点通常有多个孩子，一颗B+树包含**根节点、内部节点和叶子节点**。根节点可能是一个叶子节点，也可能是一个包含两个或两个以上孩子节点的节点。

　　B+ 树通常用于**数据库和操作系统的文件系统**中。NTFS, ReiserFS, NSS, XFS, JFS, ReFS 和BFS等文件系统都在使用B+树作为**元数据索引**。B+ 树的特点是能够保持**数据稳定有序**，其插入与修改拥有较稳定的对数时间复杂度。B+ 树元素自底向上插入。

##２.1　B＋树的性质

B+树是B-树的变体，也是一种多路搜索树，其定义基本与B-树同，除了：

１.　非叶子结点的子树指针与关键字个数相同；

２.　非叶子结点的子树指针P[i]，指向关键字值属于[K[i], K[i+1])的子树（B-树是开区间）；

３.　为所有叶子结点增加一个链指针；

４.　所有关键字都在叶子结点出现；

![这里写图片描述](http://img.blog.csdn.net/20160612134221890)　

##２.２　B＋树与Ｂ树的区别

1.　所有关键字都出现在叶子结点的链表中（稠密索引），且链表中的关键字恰好是有序的；

2.　不可能在非叶子结点命中；

3.　非叶子结点相当于是叶子结点的索引（稀疏索引），叶子结点相当于是存储（关键字）数据的数据层；

4.　**更适合文件索引系统**；

　　 B+的搜索与B-树也基本相同，区别是B+树只有达到叶子结点才命中（B-树可以在非叶子结点命中），其性能也等价于在关键字全集做一次二分查找；

#３.　B*树

B+树的变体，在B+树的非根和非叶子结点再增加指向兄弟的指针；

![这里写图片描述](http://img.blog.csdn.net/20160612134707432)　

　　 B*树定义了非叶子结点关键字个数至少为(2/3)*M，即块的最低使用率为2/3（代替B+树的1/2）；

B+树的分裂：
　　
> 当一个结点满时，分配一个新的结点，并将原结点中1/2的数据复制到新结点，最后在父结点中增加新结点的指针；B+树的分裂只影响原结点和父结点，而不会影响兄弟结点，所以它不需要指向兄弟的指针；

B*树的分裂：

>当一个结点满时，如果它的下一个兄弟结点未满，那么将一部分数据移到兄弟结点中，再在原结点插入关键字，最后修改父结点中兄弟结点的关键字（因为兄弟结点的关键字范围改变了）；如果兄弟也满了，则在原结点与兄弟结点之间增加新结点，并各复制1/3的数据到新结点，最后在父结点增加新结点的指针；

所以，B*树分配新结点的概率比B+树要低，**空间使用率更高**；

#4 总结

 - B-树：
 　　
 　　多路搜索树，每个结点存储M/2到M个关键字，非叶子结点存储指向关键字范围的子结点；所有关键字在整颗树中出现，且只出现一次，非叶子结点可以命中；

 - B+树：

　　在B-树基础上，为叶子结点增加链表指针，所有关键字都在叶子结点
中出现，非叶子结点作为叶子结点的索引；B+树总是到叶子结点才命中；

 - B*树：

　　在B+树基础上，为非叶子结点也增加链表指针，将结点的最低利用率从1/2提高到2/3；
